{"version":3,"sources":["app.js"],"names":["$","App","Collections","Models","Views","Backbone","View","extend","el","initialize","Drop","events","click .js-avatarClose","click .js-dropItem","click","e","$target","currentTarget","infoAvatarTemplate","html","infoTemplate","currentItem","this","collection","findWhere","id","data","renderedAvatar","Mustache","render","toJSON","renderedInfo","$el","find","remove","removeClass","addClass","append","hide","show","closeAvatar","on","self","each","dropItem","dropItemView","DropItem","model","get","pep","initiate","droppable","stop","event","object","$item","intersected","activeDropRegions","length","saveSelectedItem","revert","debug","place","template","tagName","className","rendered","attr","Drag","mousedown .js-dragItem","mouseup .js-dragItem:not(.pep-start)","mouseout .js-dragItem","mousedown","mouseup","itemId","css","visibility","dropItems","push","item","removeSelectedItem","$empty","availableItem","dragItem","DragItem","AvailableItems","Collection","url","fetch","reset","SelectedItems","dragItems"],"mappings":"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","file":"app.js","sourcesContent":["$(function () {\n\tvar App = {};\n\tApp.Collections = {};\n\tApp.Models = {};\n\tApp.Views = {};\n\n\t/*****************\n\t *\n\t *  Views\n\t *\n\t ******************/\n\n\t// Main view\n\tApp.Views.App = Backbone.View.extend({\n\t\tel: '.js-services',\n\t\tinitialize: function () {\n\n\t\t}\n\t});\n\n\t// Drag view\n\tApp.Views.Drop = Backbone.View.extend({\n\t\tel: '.js-drop',\n\t\tevents: {\n\t\t\t'click .js-avatarClose': 'closeAvatar',\n\t\t\t'click .js-dropItem': 'click'\n\t\t},\n\t\tclick: function (e) {\n\t\t\tvar $target = $(e.currentTarget),\n\t\t\t\tinfoAvatarTemplate = $('#selectedItemAvatarTemplate').html(),\n\t\t\t\tinfoTemplate = $('#infoTemplate').html(),\n\t\t\t\tcurrentItem = this.collection.findWhere({\n\t\t\t\t\tid: $target.data('id')\n\t\t\t\t});\n\t\t\trenderedAvatar = Mustache.render(infoAvatarTemplate, currentItem.toJSON());\n\t\t\trenderedInfo = Mustache.render(infoTemplate, currentItem.toJSON());\n\n\t\t\t$('.js-itemInfo').html(renderedInfo);\n\n\t\t\tthis.$el.find('.js-avatar').remove();\n\t\t\t$('.js-dropItem').removeClass('active');\n\t\t\t$target.addClass('active');\n\n\t\t\tthis.$el.append(renderedAvatar);\n\t\t\tthis.$el.find('.js-addBtn').hide();\n\t\t\tthis.$el.find('.js-removeBtn').show();\n\t\t},\n\t\tcloseAvatar: function () {\n\t\t\t$('.js-dragItem').removeClass('active');\n\t\t\t$('.js-dropItem').removeClass('active');\n\t\t\tthis.$el.find('.js-avatar').remove();\n\t\t},\n\t\tinitialize: function () {\n\t\t\tthis.collection.on('add', function () {\n\t\t\t\tthis.render();\n\t\t\t}, this);\n\t\t},\n\t\trender: function () {\n\t\t\tvar self = this;\n\n\t\t\tthis.$el.find('.js-selectedItems').html('');\n\t\t\tthis.collection.each(function (dropItem, index) {\n\t\t\t\tvar dropItemView = new App.Views.DropItem({\n\t\t\t\t\tmodel: dropItem\n\t\t\t\t});\n\t\t\t\tthis.$el.find('.js-selectedItems').append(dropItemView.$el.data('serviceName', dropItem.get('name')));\n\t\t\t}, this);\n\n\t\t\t// Drag init\n\t\t\t$('.js-dragItem').pep({\n\t\t\t\tinitiate: function () {\n\t\t\t\t\t// console.log('initiate');\n\t\t\t\t},\n\t\t\t\tdroppable: '.js-drop',\n\t\t\t\tstop: function (event, object) {\n\t\t\t\t\tvar $item = $(object.el),\n\t\t\t\t\t\tintersected = this.activeDropRegions.length;\n\n\n\t\t\t\t\tif (intersected) {\n\t\t\t\t\t\tself.saveSelectedItem($item);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\trevert: true,\n\t\t\t\tdebug: true,\n\t\t\t\tplace: false\n\t\t\t});\n\t\t}\n\t});\n\t// Drag item view\n\tApp.Views.DropItem = Backbone.View.extend({\n\t\ttemplate: $('#dragItemTemplate').html(),\n\t\ttagName: 'li',\n\t\tclassName: 'services__item js-dropItem',\n\t\tinitialize: function () {\n\t\t\tthis.render();\n\t\t},\n\t\trender: function () {\n\t\t\tvar rendered = Mustache.render(this.template, this.model.toJSON());\n\t\t\tthis.$el.html(rendered);\n\t\t\tthis.$el.addClass('services__item_' + this.model.get('icon'));\n\t\t\tthis.$el.attr('id', 'dropItem-' + this.model.get('id'));\n\t\t\tthis.$el.data('id', this.model.get('id'));\n\t\t\treturn this;\n\t\t}\n\t});\n\n\t// Available drag view\n\tApp.Views.Drag = Backbone.View.extend({\n\t\tel: '.js-drag',\n\t\tevents: {\n\t\t\t'mousedown .js-dragItem': 'mousedown',\n\t\t\t'mouseup .js-dragItem:not(.pep-start)': 'click',\n\t\t\t'mouseout .js-dragItem': 'mouseout'\n\t\t},\n\t\tinitialize: function () {\n\t\t\tthis.collection.on('reset', function () {\n\t\t\t\tthis.render();\n\t\t\t}, this);\n\t\t},\n\t\tmousedown: function (e) {\n\t\t\tvar $target = $(e.currentTarget);\n\t\t},\n\t\tmouseup: function (e) {\n\t\t\tvar $target = $(e.currentTarget);\n\t\t},\n\t\tclick: function (e) {\n\t\t\tvar $target = $(e.currentTarget),\n\t\t\t\tinfoTemplate = $('#selectedItemAvatarTemplate').html(),\n\t\t\t\tcurrentItem = this.collection.findWhere({\n\t\t\t\t\tid: $target.data('id')\n\t\t\t\t}),\n\t\t\t\trendered = Mustache.render(infoTemplate, currentItem.toJSON());\n\n\t\t\t$('.js-drop').find('.js-avatar').remove();\n\t\t\t$('.js-dragItem').removeClass('active');\n\t\t\t$target.addClass('active');\n\t\t\t$('.js-drop').append(rendered);\n\t\t\t$('.js-drop').find('.js-removeBtn').hide();\n\t\t\t$('.js-drop').find('.js-addBtn').show();\n\n\t\t},\n\t\tsaveSelectedItem: function ($item) {\n\t\t\tvar itemId = $item.data('id'),\n\t\t\t\tcurrentItem = this.collection.findWhere({\n\t\t\t\t\tid: itemId\n\t\t\t\t});\n\n\t\t\t$item.css({\n\t\t\t\tvisibility: 'hidden'\n\t\t\t});\n\t\t\tdropItems.push(currentItem);\n\n\t\t\t$('.js-selected').html('');\n\t\t\tdropItems.each(function (item) {\n\t\t\t\t$('.js-selected').append('<li>' + item.get('role') + ' ' + item.get('name') + '</li>');\n\t\t\t});\n\t\t},\n\t\tremoveSelectedItem: function () {\n\n\t\t},\n\t\trender: function () {\n\t\t\tvar self = this,\n\t\t\t\t$empty = $('.js-dragEmpty');\n\n\t\t\tthis.$el.html('');\n\t\t\t$empty.html('');\n\t\t\tthis.collection.each(function (availableItem, index) {\n\t\t\t\tvar dragItem = new App.Views.DragItem({\n\t\t\t\t\tmodel: availableItem\n\t\t\t\t});\n\t\t\t\tthis.$el.append(dragItem.$el.data('serviceName', availableItem.get('name')));\n\t\t\t\t$empty.append('<li class=\"services__empty-item\"></li>');\n\t\t\t}, this);\n\n\t\t\t// Drag init\n\t\t\t$('.js-dragItem').pep({\n\t\t\t\tdroppable: '.js-drop',\n\t\t\t\tstop: function (event, object) {\n\t\t\t\t\tvar $item = $(object.el),\n\t\t\t\t\t\tintersected = this.activeDropRegions.length;\n\n\t\t\t\t\tif (intersected) {\n\t\t\t\t\t\tself.saveSelectedItem($item);\n\t\t\t\t\t}\n\n\t\t\t\t},\n\t\t\t\trevert: true,\n\t\t\t\tdebug: true,\n\t\t\t\tplace: false\n\t\t\t});\n\t\t}\n\t});\n\t// Available drag item view\n\tApp.Views.DragItem = Backbone.View.extend({\n\t\ttemplate: $('#dragItemTemplate').html(),\n\t\ttagName: 'li',\n\t\tclassName: 'services__item js-dragItem',\n\t\tinitialize: function () {\n\t\t\tthis.render();\n\t\t},\n\t\trender: function () {\n\t\t\tvar rendered = Mustache.render(this.template, this.model.toJSON());\n\t\t\tthis.$el.html(rendered);\n\t\t\tthis.$el.addClass('services__item_' + this.model.get('icon'));\n\t\t\tthis.$el.attr('id', 'dragItem-' + this.model.get('id'));\n\t\t\tthis.$el.data('id', this.model.get('id'));\n\t\t\treturn this;\n\t\t}\n\t});\n\n\n\t/*****************\n\t *\n\t *  Collections\n\t *\n\t ******************/\n\n\t// Available items\n\tApp.Collections.AvailableItems = Backbone.Collection.extend({\n\t\turl: $('#dragItemTemplate').data('url'),\n\t\tinitialize: function () {\n\t\t\tthis.fetch({\n\t\t\t\treset: true\n\t\t\t});\n\t\t}\n\t});\n\t// Selected items\n\tApp.Collections.SelectedItems = Backbone.Collection.extend({});\n\n\n\t/*****************\n\t *\n\t *  Initialize\n\t *\n\t ******************/\n\tvar dragItems = new App.Collections.AvailableItems(),\n\t\tdropItems = new App.Collections.SelectedItems();\n\n\tvar appView = new App.Views.App(),\n\t\tdragView = new App.Views.Drag({\n\t\t\tcollection: dragItems\n\t\t}),\n\t\tdropView = new App.Views.Drop({\n\t\t\tcollection: dropItems\n\t\t});\n});\n"],"sourceRoot":"/source/"}